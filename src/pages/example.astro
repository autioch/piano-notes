---
import type { Pitch, Bar as BarType, BarFinish, Duration } from "@/types/piano";
import Layout from "@/components/Layout.astro";
import SheetMusic from "@/components/SheetMusic.astro";
import { ALL_DURATIONS, ALL_FINISHES, ALL_PITCHES } from "@/consts";
import A4Paper from "@components/atoms/A4Paper.astro";

const notes = ALL_PITCHES.flatMap((pitch) =>
  ALL_DURATIONS.map((duration) => ({
    pitch,
    duration,
  }))
);

/* Split notes array into array of arrays of 4 items */
const bars: BarType[] = [];
for (let i = 0; i < notes.length; i += 4) {
  bars.push({
    notes: notes.slice(i, i + 4),
    type: ALL_FINISHES[(i / 4) % ALL_FINISHES.length],
  });
}
---

<Layout>
  <A4Paper>
    <SheetMusic
      sheetMusic={{
        bars,
        composer: "Example",
        key: "violin",
        meter: [4, 4],
        title: "Example",
      }}
    />
  </A4Paper>
</Layout>
