---
import type {
  Pitch,
  Bar as BarType,
  BarFinish,
  Duration,
} from "../types/piano";
import Layout from "../components/Layout.astro";
import SheetMusic from "../components/SheetMusic.astro";

const pitches: Pitch[] = ["C", "D", "E", "F", "G", "A", "H"];
const durations: Duration[] = [1, 0.5, 0.25, 0.125];
const barFinish: BarFinish[] = [
  "normal",
  "double",
  "double-end",
  "repeat-end",
  "repeat-start",
];

const notes = pitches.flatMap((pitch) =>
  durations.map((duration) => ({
    pitch,
    duration,
  }))
);

/* Split notes array into array of arrays of 4 items */
const bars: BarType[] = [];
for (let i = 0; i < notes.length; i += 4) {
  bars.push({
    notes: notes.slice(i, i + 4),
    type: barFinish[(i / 4) % barFinish.length],
  });
}
---

<Layout>
  <SheetMusic
    sheetMusic={{
      bars,
      composer: "Example",
      key: "violin",
      meter: [4, 4],
      title: "Example",
    }}
  />
</Layout>
